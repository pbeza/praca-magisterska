###############################################################################
# myscm-srv configuration file.                                               #
###############################################################################

# DESCRIPTION
#
# This is configuration of the myscm-srv that specifies which files and
# directories of the system will be tracked and archived within system's image
# created with --gen-img option (see also --aide-config option). Alongside this
# configuration file there is another configuration file, typically saved in
# /etc/myscm-srv/config.ini (see --config option) that contains remaining
# myscm-srv options, e.g. SSL certificates paths, logging configuration,
# application verbosity, output directory and more.
#
#
# CONFIGURATION SYNTAX
#
# This file uses extended AIDE syntax. All configuration options valid in AIDE
# are valid here, however not all options supported by AIDE are recommended,
# tested and guaranteed to be working as expected. E.g. `summarize_changes`
# option is forced to be set to `yes` even if this file sets it to `no`.
# `verbosity`, `grouped` and `report_base16` options are assumed to be set to
# `6`, `yes` and `no` respectively. In fact most of the options besides paths
# to tracked files and directories are assumed to be set as it is (this may
# change in future releases of the myscm-srv). If you want to learn more about
# AIDE configuration syntax see aide.conf(5) manual.
#
# Lines that begin with '#' are treated as comments except those lines that
# starts with '#@' that indicate myscm-srv extended AIDE configuration syntax.
# '#@' precedes path of the file or directory that that will be recursively
# copied to the aide.db[.X] directory while running mysm-srv with --scan
# option. This behaviour was implemented to make possible for myscm-srv to
# create patches (using `diff`) of the modified text files instead copying
# whole files. Binary files are ignored (not copied) since there is no point in
# making patch of binary file.


###############################################################################
# AIDE SYNTAX SECTION.                                                        #
#   AIDE configuration of the tracked files and directories.                  #
###############################################################################

# The url from which database is read. There can only be one of these lines. If
# there are multiple database lines then the first is used. There is no valid
# default value in the Debian packages!

database = file:/var/lib/myscm-srv/aide.db.current/aide.db

# The url to which the new database is written to. There can only be one of
# these lines. If there are multiple database_out lines then the first is used.
# There is no valid default value in the Debian packages!

database_out = file:/var/lib/myscm-srv/aide.db.new/aide.db.new

# The url from which the other database for --compare is read. There is no
# default for this one.

database_new = file:/var/lib/myscm-srv/aide.db.current/aide.db.0

# Whether the output to the database is gzipped or not. Valid values are
# yes,true,no and false. The default is no. This option is available only if
# zlib support is compiled in.

gzip_dbout = no

# Whether to summarize changes in the added, removed and changed files sections
# of the report or not. Valid values are yes,true,no and false. The default is
# to summarize the changes. See aide.conf(5) manual to learn more.

summarize_changes = yes

# Whether to group the files in the report by added, removed and changed files
# or not. Valid values are yes, true, no and false. The default is to group
# the files in the report.

grouped = yes

# The level of messages that is output. This value can be 0-255 inclusive. This
# parameter can only be given once. Value from the first occurrence is used. If
# --verbose or -V is used then the value from that is used. The default is 5.
# If verbosity is 20 then additional  report  output  is  written when doing
# --check, --update or --compare.

verbose = 6

# Whether to base16 encode the checksums in the report or not. Valid values are
# yes, true, no and false. The default is to report checksums not in base16 but
# in base64 encoding.

report_base16 = no

# Group definition. Value is then regarded as an expression. Expression is of
# the following form.
#
#     <predefined group>| <expr> + <predefined group>
#                       | <expr> - <predefined group>
#
# See aide.conf(5) manual to learn more.

MyRule = p+ftype+i+n+l+u+g+s+b+m+c+md5+sha1+crc32

/bin MyRule
# /boot
# /dev
/etc MyRule
# /home
/lib MyRule
/lib32 MyRule
/lib64 MyRule
/libx32 MyRule
# /lost+found
# /media
# /mnt
# /opt
# /proc
# /root
# /run MyRule
/sbin MyRule
/srv MyRule
# /sys
# /tmp
/usr MyRule
# /var
# /vmlinuz


###############################################################################
# EXTENDED AIDE SYNTAX SECTION                                                #
#   Extended myscm-srv syntax specifying files and directories that will be   #
#   copied when running myscm-srv with --scan option to make it possible to   #
#   make patches (diffs) of the altered files' instead of copying them to the #
#   system image created with --gen-img option. This behaviour is intended to #
#   make system image as small as possible. Files that were altered but were  #
#   not specified below are copied to the system image. Note that all of the  #
#   below listed directories will be copied recursively even if they are not  #
#   added in the above rules. Symlinks are being expanded before copying.     #
#   Note that there is no point in copying binary files since typically it's  #
#   not sane to make patches of the binary files.                             #
###############################################################################

#@ /etc
