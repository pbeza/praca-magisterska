\documentclass[thesis]{subfiles}

\begin{document}

\chapter{Implementacja}

W~niniejszym rozdziale przedstawiono szczegóły implementacyjne projektu, w~szczególności zastosowane biblioteki i~narzędzia pomocnicze.

%------------------------------------------------------------------------------

\section{Moduły}

Aplikacja składa się z~części serwerowej i~klienckiej nazywanej w~kodzie źródłowym odpowiednio \texttt{myscm-srv} i~\texttt{myscm-cli}\footnote{\emph{myscm} to~skrót od~roboczej nazwy \emph{My~\href{https://en.wikipedia.org/wiki/Software_configuration_management}{Software Configuration Manager}}}. Każda z~tych części składa się z~modułów realizujących rozłączone zadania.

Główne moduły serwera:\mynobreakpar
\begin{itemize}
	\item moduł skanujący system wzorcowy i~tworzący plik stanu systemu,
	\item moduł udostępniający klientom obraz zmian konfiguracji powstałej na~podstawie skanowania systemu wzorcowego,
	\item moduł konfiguracji serwera z~ustawieniami takimi parametrami jak np.~numer portu nasłuchiwania na~połączenia klientów, czas między kolejnymi skanowaniami systemu~itp.
\end{itemize}

Główne moduły klienta:\mynobreakpar
\begin{itemize}
	\item moduł odbierający, weryfikujący podpis cyfrowy i~rozpakowujący obraz zmian konfiguracji wzorcowej, udostępnionej przez serwer,
	\item parser konfiguracji klienta z~ustawieniami takimi jak np.~numer portu nasłuchiwania serwera, czas między kolejnymi odpytaniami serwera o~aktualizację systemu~itp.
\end{itemize}

%------------------------------------------------------------------------------

\section{Aplikacja serwera}

\newcommand{\srvappname}{myscm-srv}
\newcommand{\myscmsrvconfig}{\path{/etc/myscm-srv/myscm-srv.conf}}

Aplikacja serwera to~aplikacja przeznaczona do~użycia na~maszynie będącej wzorcem oprogramowania dla~klientów. Służy ona do~dwóch celów --- do~stworzenia obrazu zmian konfiguracji przeprowadzonych przez administratora komputerowego od~czasu pierwszego skanowania~(por.~rozdział~\ref{sec:tworzenie-obrazu-konfiguracji}) i~do~udostępnienia takiego obrazu klientowi~(por.~rozdział~\ref{sec:przeslanie-obrazu-konfiguracji}). Główną funkcjonalnością aplikacji serwera jest stworzenie obrazu zmian konfiguracji, ponieważ utworzony obraz może być udostępniony klientowi w~dowolny inny sposób --- np.~za~pomocą protokołów \href{https://en.wikipedia.org/wiki/Trivial_File_Transfer_Protocol}{TFTP}~(\emph{Trivial File Transfer Protocol}), \href{https://en.wikipedia.org/wiki/SSH_File_Transfer_Protocol}{SFTP}~(\emph{SSH File Transfer Protocol}), \href{https://en.wikipedia.org/wiki/File_Transfer_Protocol}{FTP} lub~własnego protokołu --- wszystkie te~protokoły wspiera aplikacja kliencka, a~ponadto ma~możliwość załadowania obrazu zmian konfiguracji z~wybranego pliku.

\begin{lstlisting}[label=lst:myscm-srv-usage,numbers=none,caption={Szablon użycia aplikacji serwera}]
myscm-srv [OPCJE]
\end{lstlisting}

Szczegółowa instrukcja obsługi użycia aplikacji serwera została dostarczona z~pakietem oprogramowania \texttt{\srvappname}~(patrz:~załącznik~\ref{ch:cd-appendix}). Instrukcję można otworzyć po~zainstalowaniu pakietu \texttt{\srvappname} za~pomocą komendy \texttt{man~\srvappname}. Konfiguracja aplikacji znajduje się w~katalogu \myscmsrvconfig. Listing~\ref{lst:myscm-srv-usage} przedstawia skrócony opis użycia aplikacji serwera, gdzie \texttt{OPCJE} oznaczają następujące dozwolone argumenty:\mynobreakpar
\setlist[description]{style=nextline,font=\ttfamily}
\begin{description}
	\item[-i, --init {[aide\_config\_file]}]\hypertarget{itm:srv-init} Inicjuje bazę \hyperref[sec:aide]{AIDE} korzystając z~pliku konfiguracyjnego~AIDE wskazywanego przez plik konfiguracyjny aplikacji serwera lub~przez opcjonalny parametr \path{aide_config_file}. Tak~stworzona baza jest referencyjną konfiguracją systemu wzorcowego, która będzie porównywana z~kolejnymi wynikami skanowań (patrz: \hyperlink{itm:srv-update}{\texttt{--update}}). Wynik skanowania zostaje zapisany do~katalogu ustawionego w~konfiguracji aplikacji --- domyślnie jest to~katalog \path{/var/lib/aide}.
	\item[--update]\hypertarget{itm:srv-update} Skanuje system w~poszukiwaniu zmian od~pierwszego skanowania \hyperref[sec:aide]{AIDE} wykonanego za~pomocą opcji \hyperlink{itm:srv-init}{\texttt{--init}}. Wynikiem skanowania jest aktualizacja ostatniej, porównawczej bazy danych~AIDE, na~podstawie której może powstać obraz zmian konfiguracji systemu wzorcowego (patrz: \hyperlink{itm:srv-gen-img}{\texttt{--gen-img}}).
	\item[--upgrade] Wywołuje najpierw opcję \hyperlink{itm:srv-update}{\texttt{--update}}, a~następnie \hyperlink{itm:srv-gen-img}{\texttt{--gen-img}}.
	\item[-g, --gen-img]\hypertarget{itm:srv-gen-img} Tworzy obraz zmian na~podstawie pierwszego i~ostatniego skanowania~AIDE wykonanego odpowiednio za~pomocą opcji \hyperlink{itm:srv-init}{\texttt{--init}} i~\hyperlink{itm:srv-update}{\texttt{--update}}.
	\item[-c, --config config\_file] Domyślnie konfiguracja aplikacji serwera jest czytana z~pliku tekstowego \myscmsrvconfig. Ta~opcja zmienia to~zachowanie wczytując zadaną konfigurację z~pliku tekstowego \texttt{config\_file}.
	\item[-d, --daemonize] Uruchamia aplikację w~tle. Wszystkie komunikaty programu zostają przekierowane do~\hreftt{https://en.wikipedia.org/wiki/Syslog}{sysloga}.
	\item[-s, --share {[myscm\_img\_file]}]\hypertarget{itm:srv-share} Włącza udostępnianie obrazu utworzonego za~pomocą opcji \hyperlink{itm:srv-gen-img}{\texttt{--gen-img}} na~porcie określonym przez konfigurację serwera lub~na~porcie \texttt{port\_number} określonym przez opcję \hyperlink{itm:srv-port}{\texttt{--port}}. Jeśli \texttt{myscm\_img\_file} jest podany, to~zamiast domyślnego obrazu, jest udostępniany obraz określony ścieżką \texttt{myscm\_img\_file}.
	\item[-p, --port {[port\_number]}]\hypertarget{itm:port} Ustawia port nasłuchu na~klientów na~\texttt{port\_number}. Ta~opcja ma~sens tylko w~połączeniu z~opcją \hyperlink{itm:srv-share}{\texttt{--share}}.
	%\item[--force]
	\item[--version] Wypisuje informację o~wersji i~licencji programu.
	\item[-h, --help] Wypiuje pomoc z~informacjami o~dozwolonych opcjach programu i~ich znaczeniu.
	\item[-v, --verbose] Włącza tryb ,,gadatliwy", tzn.~włącza wypisywanie dodatkowych komunikatów mogących okazać się pomocnymi przy diagnozowaniu ewentualnych problemów z~działaniem programu.
\end{description}

%------------------------------------------------------------------------------

\section{Aplikacja kliencka}

\newcommand{\cliappname}{myscm-cli}
\newcommand{\myscmcliconfig}{\path{/etc/myscm-cli/myscm-cli.conf}}

Aplikacja kliencka to~aplikacja przeznaczona do~użycia na~maszynie, której konfigurację administrator chce dostosować do~konfiguracji systemu wzorcowego. Aplikacja kliencka umożliwia pobranie obrazu zmian konfiguracji z~serwera za~pomocą \href{https://en.wikipedia.org/wiki/Trivial_File_Transfer_Protocol}{TFTP}~(\emph{Trivial File Transfer Protocol}), \href{https://en.wikipedia.org/wiki/SSH_File_Transfer_Protocol}{SFTP}~(\emph{SSH File Transfer Protocol}), \href{https://en.wikipedia.org/wiki/File_Transfer_Protocol}{FTP} lub~własnego protokołu.

\begin{lstlisting}[numbers=none,language=,caption={Szablon użycia aplikacji klienckiej dostosowującej konfigurację systemu klienta do~konfiguracji pobranej z~serwera o~IP \texttt{server\_IP} lub~z~pliku obrazu konfiguracji określonego ścieżką \texttt{myscm\_img\_file}},label=lst:myscm-cli-usage]
myscm-cli [OPCJE] [server_IP | myscm_img_file]
\end{lstlisting}

Szczegółowa instrukcja obsługi użycia aplikacji kliencka, analogicznie jak w~przypadku aplikacji serwera, została dostarczona z~pakietem oprogramowania \texttt{\cliappname}~(patrz:~załącznik~\ref{ch:cd-appendix}). Instrukcję można otworzyć po~zainstalowaniu pakietu \texttt{\cliappname} za~pomocą komendy \texttt{man~\cliappname}. Listing~\ref{lst:myscm-cli-usage} przedstawia skrócony opis użycia aplikacji klienckiej, gdzie \texttt{OPCJE} oznaczają następujące dozwolone argumenty:\mynobreakpar
\begin{description}
	\item[--upgrade] Pobiera obraz zmian konfiguracji z~serwera i~stosuje~ją.
	\item[--update] Pobiera obraz zmian konfiguracji z~serwera i~nie stosuje jej. Jeśli w~wyołaniu komendy \texttt{\cliappname} nie został podany numer IP~serwera (\texttt{server\_IP}), to~zostaje on~pobrany z~pliku konfiguracyjnego klienta \myscmcliconfig. Miejsce przechowywania pobranego obrazu zmian jest również zdefiniowane w~konfiguracji klienta.
	\item[--SFTP]
	\item[--FTP]
	\item[--cert X509\_cert\_file]
	\item[--daemonize]
	\item[--force]
	\item[-p, --port number]
	\item[--version] Wypisuje informację o~wersji i~licencji programu.
	\item[-h, --help] Wypiuje pomoc z~informacjami o~dozwolonych opcjach programu i~ich znaczeniu.
	\item[-v, --verbose] Włącza tryb ,,gadatliwy", tzn.~włącza wypisywanie dodatkowych komunikatów mogących okazać się pomocnymi przy diagnozowaniu ewentualnych problemów z~działaniem programu.
\end{description}

%------------------------------------------------------------------------------

\section{Kod źródłowy}

Kod źródłowy projektu został w~całości napisany w~języku \href{https://en.wikipedia.org/wiki/Python_(programming_language)}{Python} w~najnowszej dostępnej wersji~3.6.1. Źródła projektu znajdują się na~płycie~CD dołączonej do~tej pracy (patrz załącznik~\ref{ch:cd-appendix}) w~katalogu~\path{/src}, a~dokumentacja wygenerowana z~komentarzy kodu źródłowego w~\path{/doc/python}.

Kod źródłowy został sformatowany zgodnie z~wymogami \href{https://www.python.org/dev/peps/pep-0008/}{PEP~8} (\emph{Python Enhancement Proposals}) pt.~\emph{Style Guide for Python Code} i~\href{https://www.python.org/dev/peps/pep-0257/}{PEP~257} pt.~\emph{Docstring Conventions}. Do~sprawdzenia zgodności napisanego kodu ze~standardem~PEP~8 wykorzystano narzędzie \hreftt{https://pypi.python.org/pypi/flake8}{flake8}, który obudowuje (\emph{wrapper}) narzędzia \hreftt{https://pypi.python.org/pypi/pep8}{pep8}, \hreftt{https://pypi.python.org/pypi/pyflakes}{pyflakes}, \hreftt{https://pypi.python.org/pypi/pycodestyle}{pycodestyle} i~\hreftt{https://pypi.python.org/pypi/mccabe}{mccabe}. Edytorem kodu wykorzystanym do~implementacji był \texttt{vim} rozbudowany o~\href{http://vimawesome.com/}{wtyczki}~(\emph{plugins}).

%------------------------------------------------------------------------------

\section{Wykorzystane biblioteki}

Do~implementacji projektu wykorzystano wiele \href{https://docs.python.org/dev/tutorial/modules.html}{modułów} Pythona, kilka pomocniczych aplikacji i~bibliotek. Wyróżnione z~nich~to:
\begin{itemize}
	\item \href{http://aide.sourceforge.net/}{AIDE} (\emph{Advanced Intrusion Detection Environment}) --- skaner integralności plików zaprojektowany w~celu wykrywania złośliwego oprogramowania, np.~\hrefemph{https://en.wikipedia.org/wiki/Rootkit}{rootkitów}. W~niniejszym projekcie został wykorzystany do~wykrywania zmian w~konfiguracji systemu wzorcowego (patrz rozdział~\ref{sec:aide}).
	\item \href{http://www.pyopenssl.org/}{pyOpenSSL} --- \hrefemph{https://en.wikipedia.org/wiki/Language_binding}{Binding} dla~biblioteki OpenSSL. Biblioteka ta~implementuje wiele protokołów i~algorytmów kryptograficznych, ale~w~ramach projektu została wykorzystana tylko w~celu umożliwia uwierzytelnienie serwera przez klienta przez użycie certyfikatów cyfrowych.
%	\item \hreftt{http://zeromq.org/}{ØMQ} --- Znana jest również pod~nazwą \emph{ZeroMQ} --- biblioteka implementująca różne wzorce przekazywania komunikatów~(\emph{messaging library}), dedykowana przede wszystkim dla~wydajnych, rozproszonych środowisk sieciowych. Wzorcem wykorzystanym w~implementacji niniejszego projektu jest wzorzec \hrefemph{https://rfc.zeromq.org/spec:29/PUBSUB/}{Publish-Subscribe}, implementowany na~różne sposoby --- jednym ze~sposobów jest wykorzystanie protokołu~\hyperref[subsec:pgm]{PGM}, pośrednio implementowanego przez~\href{https://en.wikipedia.org/wiki/ZeroMQ}{ØMQ} przez wykorzystanie implementacji \href{https://github.com/steve-o/openpgm}{OpenPGM}. Biblioteka została napisana w~języku~C++, ale~powstały również \emph{bindingi} dla~ponad 40~innych języków programowania --- m.in.~dla~Pythona, w~którym został zaimplementowany niniejszy projekt. ØMQ~została opublikowana na~warunkach licencji~\glslink{lgpl}{LGPL}.
%	\item \hreftt{https://en.wikipedia.org/wiki/Squid_(software)}{Squid} lub\footnote{TODO --- wybór tego, który lepiej się sprawdzi --- oba da się skonfigurować do~pracy na~\emph{Debianie} i~\emph{Archu}.} \hreftt{https://www.unix-ag.uni-kl.de/~bloch/acng/html/}{Apt-Cacher-NG} jako serwer buforujący pakiety oprogramowania dla~klienta (\href{https://lwn.net/Articles/318658/}{Package Repository Proxy}).
%Istnieje wiele bibliotek kryptograficznych, które, pod~warunkiem poprawnego użycia, mogą istotnie poprawić bezpieczeństwo protokołu. Najpopularniejsze z~nich~to: \emph{\gls{openssl}}, \emph{GnuTLS}, \emph{LibreSSL} i~\emph{BoringSSL}. Biblioteką istniejącą najdłużej z~wymienionych jest \gls{openssl}. Biblioteka GnuTLS powstała w~odpowiedzi na~\gls{openssl} ze~względu na~to, że~\gls{openssl} nie jest opublikowana na~licencji kompatybilnej z~licencją~\glslink{gpl}{GPL}, przez co~liczne projekty korzystające licencji~\glslink{gpl}{GPL} (np.~\emph{Wireshark}), nie mogą korzystać z~\gls{openssl}. Biblioteki LibreSSL i~BoringSSL są~\emph{fork'ami} biblioteki \gls{openssl}. BoringSSL powstał w~\emph{Google} na~potrzeby użycia w~różnych produktach tej firmy, w~szczególności w~przeglądarce internetowej Chrome. Długa historia \gls{openssl}, mnogość bibliotek pokrewnych, mających źródło w~kodzie źródłowym \gls{openssl} oraz~względnie duża społeczność kryptologów zgromadzonych wokół tego projektu, spowodowały, że~biblioteka \gls{openssl} została użyta do~zapewnienia bezpieczeństwa opracowanego protokołu sieciowego.
%\gls{openssl} udostępnia wiele metod i~algorytmów kryptograficznych, które przetrwały wiele lat kryptoanaliz (np.~\gls{aes}, \gls{rsa}) i~są powszechnie uważane za~bezpieczne, pod~warunkiem poprawnego ich~wykorzystania i~zastosowania kluczy o~odpowiednio dużej długości. Wykorzystanie tej biblioteki w~kontekście komunikacji między klientem i~serwerem zostało opisane w~rozdziale~\ref{sec:security}, dotyczącym bezpieczeństwa opracowanego protokołu.
%	\item \hreftt{http://pyyaml.org/}{PyYAML} --- Służy do~parsowania plików konfiguracyjnych \texttt{YAML} serwera i~klienta.
\end{itemize}

%------------------------------------------------------------------------------

\section{AIDE}
\label{sec:aide}

Kluczowym narzędziem wykorzystanym w~implementacji projektu jest~\href{http://aide.sourceforge.net/}{AIDE}~(\emph{Advanced Intrusion Detection Environment}). \href{https://wiki.archlinux.org/index.php/AIDE}{AIDE}~jest oprogramowaniem zaprojektowanym z~myślą wykrywania zmian w~systemie plików w~celu wykrycia złoźliwego oprogramowania\footnote{Taki rodzaj oprogramowania jest nazywany oprogramowaniem~\href{https://en.wikipedia.org/wiki/Host-based_intrusion_detection_system_comparison}{HIDS}~(\hrefemph{https://wiki.archlinux.org/index.php/List_of_applications/Security\#Threat_and_vulnerability_detection}{Host-based Intrusion Detection System}).}, jednak sposób jego działania nie ogranicza wykorzystania go~tylko do~tego celu. AIDE~został zapoczątkowany przez \href{http://www.ipi.fi/~rammer/cv.html}{Ramiego Lehtiego}\footnote{\href{http://www.ipi.fi/~rammer/cv.html}{Będącego} w~latach 1996--1999 administratorem komputerowym w~\href{http://www.tut.fi/en}{Tampere University of~Technology~(TUT)} w~Finlandii.} oraz~\href{https://www.linkedin.com/in/pablo-virolainen-73501731/}{Pablo Virolainena} w~1999~roku. AIDE~jest w~całości napisany w~języku~\href{https://en.wikipedia.org/wiki/C_(programming_language)}{C} i~jest objęty \glslink{gpl}{licencją~GPL}.

Działanie AIDE polega na~wykonywaniu migawek systemu~(\emph{snapshot}) zawierającego m.in.~skróty plików~(\emph{files' \href{https://en.wikipedia.org/wiki/Hash_function}{hashes}}), czas ich~modyfikacji, uprawnienia i~inne parametry plików zdefiniowane przez administratora w~konfiguracji \path{/etc/aide/aide.conf}. Konfiguracja ta~jest zapisana w~formacie podobnym do~tego, który został użyty w~komercyjnym oprogramowaniu \hrefemph{https://en.wikipedia.org/wiki/Open_Source_Tripwire}{Tripwire}, będącym pierwowzorem dla~AIDE. Pierwsza migawka systemu wykonana komendą \texttt{aide --init} typowo powinna zostać wykonana na~dopiero~co zainstalowanym systemie operacyjnym przed podłączeniem go~do~sieci i~zostać zapisana na~systemie plików tylko do~odczytu~(\emph{read-only}) lub~na~nośniku niepodłączonym do~działającego systemu (\hrefemph{https://www.techopedia.com/definition/30275/cold-storage}{cold storage}), ponieważ jest ona~referencyjnym stanem systemu, będącym punktem odniesienia dla~kolejnych migawek\footnote{Instrukcja użytkownika AIDE \href{http://aide.sourceforge.net/stable/manual.html\#usage}{zaleca} przeniesienie na~bezpieczne nośniki również binaria, konfigurację i~instukcję ~AIDE.}. Zapisanie pierwszej migawki na~partycji \href{https://linux.die.net/man/8/mount}{zamontowanej} w~trybie tylko do~odczytu i/lub~umieszczenie jej~na~bezpiecznym nośniku minimalizuje ryzyko jej modyfikacji z~jakiegokolwiek powodu --- np.~z~powodu złośliwego oprogramowania, awarii, przypadkowego nadpisania~itd. Migawki wykonane podczas kolejnych skanowań, wykonane komendą \texttt{aide~-C}, są~porównywane z~pierwszą migawką i~na~tej podstawie AIDE~tworzy tekstowy raport zmian.

\begin{lstlisting}[language=,caption={Zawartość pliku \protect\path{/etc/aide/aide.conf} z~przykładową konfiguracją~AIDE (ze~strony~\hreftt{http://aide.sourceforge.net/stable/manual.html}{aide.sourceforge.net/stable/manual.html})},label=lst:aide-config,escapechar=|]
MyRule = p+i+n+u+g+s+b+m+c+md5+sha1|\label{line:custom-rule}|
/etc p+i+u+g     # check only permissions, inode, user and group for etc
/bin MyRule      # apply the custom rule to the files in bin
/sbin MyRule     # apply the same custom rule to the files in sbin
/var MyRule
!/var/log/.*     # ignore the log dir it changes too often|\label{line:var-log}|
!/var/spool/.*   # ignore spool dirs as they change too often|\label{line:spool}|
!/var/adm/utmp$  # ignore the file /var/adm/utmp|\label{line:var-adm-utmp}|
\end{lstlisting}

W~drzewie katalogów systemów \glslink{unix-like-system}{*niksowych}\footnote{Struktura drzewa katalogów systemów \glslink{unix-like-system}{*niksowych} jest zdefiniowana przez \hrefemph{https://wiki.linuxfoundation.org/lsb/fhs}{Filesystem Hierarchy Standard}~(\href{http://www.tldp.org/LDP/sag/html/fs-background.html}{FHS}).} istnieją katalogi systemowe, tzn.~katalogi niebędące katalogiem domowym użytkownika ani jego podkatalogiem, których zawartość zmienia się np.~co~każde uruchomienie systemu i~takie zachowanie nie powinno zazwyczaj niepokoić administratora, dlatego powinny być one (i~część z~nich jest domyślnie) wyłączone ze~skanowania~AIDE. Do~takich katalogów należą~m.in.~katalogi:

\begin{itemize}
	\item \hreftt{http://www.tldp.org/LDP/sag/html/var-fs.html}{/var} --- katalog, w~którym znajdują się \href{http://www.linuxpl.org/SAG/x547.html}{m.in.}~logi w~\path{/var/log}, blokady plików w~\path{/var/lock}, \emph{cache} w~\path{/var/cache}, \href{http://www.tldp.org/HOWTO/Printing-Usage-HOWTO-2.html}{kolejki wydruku} i~kolejki pocztowe w~\path{/var/spool}~itp.,
	\item \hreftt{http://www.tldp.org/LDP/Linux-Filesystem-Hierarchy/html/tmp.html}{/tmp} --- katalog z~danymi tymczasowymi.
\end{itemize}

 Do~katalogów, które również powinny być wyłączone ze~skanowania AIDE należą katalogi specjalne, np.~katalogi wirtualne, których istnienie zapewnia w~locie (\emph{on the fly}) \glslink{kernel}{jądro} systemu operacyjnego:

\begin{itemize}
	\item \hreftt{https://www.kernel.org/doc/Documentation/filesystems/sysfs.txt}{/sys} --- katalog zawierający m.in.~informacje o~urządzeniach podłączonych do~komputera,
	\item \hreftt{http://www.tldp.org/LDP/sag/html/proc-fs.html}{/proc} --- katalog \hreftt{https://en.wikipedia.org/wiki/Procfs}{procfs}, zawierający informacje o~działających procesach,
	\item \hreftt{http://www.tldp.org/LDP/sag/html/dev-fs.html}{/dev} --- katalog zawierający \href{https://en.wikipedia.org/wiki/Device_file}{pliki urządzeń},
	\item \hreftt{https://unix.stackexchange.com/questions/13972/what-is-this-new-run-filesystem/13973}{/run} --- katalog zawierający dane dotyczące np.~aktualnie zalogowanych użytkowników i~działających \glslink{demon}{demonów}; często montowany w~systemie plików \hreftt{https://wiki.archlinux.org/index.php/Tmpfs}{tmpfs}.
	\item \hreftt{http://www.tldp.org/LDP/Linux-Filesystem-Hierarchy/html/media.html}{/media} --- miejsce montowania np.~tymczasowo podłączonych nośników danych (\emph{removable media}),
	\item \hreftt{http://www.tldp.org/LDP/Linux-Filesystem-Hierarchy/html/mnt.html}{/mnt} --- miejsce tymczasowego montowania systemów plików.
\end{itemize}

W~ramach niniejszej pracy AIDE został wykorzystany do~badania zmian w~konfiguracji systemu wzorcowego. Listing~\ref{lst:aide-config} przedstawia przykładową konfigurację~AIDE. W~\hyperref[line:custom-rule]{pierwszej linii} została zdefiniowana reguła, która określa jakie parametry pliku definiują jego stan. W~tym przykładzie są~to \href{https://www.linux.com/learn/understanding-linux-file-permissions}{uprawnienia do~pliku}~(\texttt{p}), \href{https://en.wikipedia.org/wiki/Inode}{i-węzeł}~(\texttt{i}), liczba \href{https://en.wikipedia.org/wiki/Hard_link}{dowiązań twardych}~(\texttt{n}), nazwa użytkownika~(\texttt{u}), nazwa grupy~(\texttt{g}), wielkość pliku~(\texttt{s}), liczba zajmowanych bloków pamięci~(\texttt{b}), czas modyfikacji \hreftt{http://leksykot.top.hell.pl/lx3/N/atime_mtime_ctime}{mtime}~(\texttt{m}), czas zmiany \hreftt{http://leksykot.top.hell.pl/lx3/N/atime_mtime_ctime}{ctime}~(\texttt{c})\footnote{\texttt{mtime} to~czas ostatniej zmiany zawartości pliku. \texttt{ctime} to~czas ostatniej zmiany informacji o~pliku (np.~zawartości, uprawnień~itd.). \texttt{atime} to~czas ostatniego dostępu do~pliku. $\texttt{mtime} \leq \texttt{ctime} \leq \texttt{atime}$.}. Dwa ostatnie parametry --- \texttt{md5} i~\texttt{sha1} --- definiują funkcje skrótu jakie zostaną użyte do~obliczenia \emph{hashy} plików znajdujących się w~katalogach z~zastosowaną tą~regułą (w~przykładzie są~to~katalogi \path{/bin}, \path{/sbin} i~\path{/var}). Linie~\ref{line:var-log}, \ref{line:spool} i~\ref{line:var-adm-utmp} zaczynają się znakiem wykrzyknika, co~oznacza, że~te~katalogi mają nie być skanowane przez~AIDE.

AIDE jest dostępny w~wielu repozytoriach oprogramowania różnych dystrybucji \glslink{unix-like-system}{*niksowych}. Pakiet oprogramowania dostępny w~repozytorium Debiana tworzy dodatkowe pliki konfiguracyjne i~skrypt opakowujący \hreftt{https://www.apt-browse.org/browse/debian/jessie/main/all/aide-common/0.16~a2.git20130520-3/file/usr/bin/aide.wrapper}{aide.wrapper}, który uniemożliwia uruchomienie więcej niż~jednej instancji AIDE tworząc plik (\hrefemph{https://unix.stackexchange.com/questions/12815/what-are-pid-and-lock-files-for}{lock file}) \path{/var/run/aide.lock}, za~pomocą skryptu \hreftt{https://www.apt-browse.org/browse/debian/jessie/main/all/aide-common/0.16~a2.git20130520-3/file/usr/sbin/update-aide.conf}{update-aide.conf} scala do~pliku \path{/var/lib/aide/aide.conf.autogenerated} konfigurację AIDE rozproszoną po~plikach \emph{rule files}, umieszczonych w~katalogu \path{/etc/aide.conf.d} oraz~uruchamia właściwy program \hreftt{https://linux.die.net/man/1/aide}{aide}. Instalacja AIDE na~Debianie domyślnie uruchamia AIDE codziennie za~pomocą \hreftt{https://en.wikipedia.org/wiki/Cron}{crona}. Konfiguracja dotycząca działań \texttt{crona} i~AIDE znajduje się w~plikach \path{/etc/default/aide} i~w~\texttt{/etc/cron.daily/aide} (który wywołuje \texttt{aide.wrapper}). Domyślnie baza stworzona ze~skanowania systemu jest tworzona w~pliku \path{/var/lib/aide/aide.db.new}. Logi z~działania AIDE są~domyślnie dostępne w~pliku \path{/var/log/aide/aide.log}. Szczegóły instalacyjne specyficzne dla~Debiana można znaleźć w~pliku \path{/usr/share/doc/aide-common/README.Debian.gz} --- w~szczególności można znaleźć tam wskazówki dotyczące inicjalizacji bazy AIDE za~pomocą skryptu \path{/usr/sbin/aideinit} (\emph{wrapper}) zamiast \texttt{aide~--init}.

%------------------------------------------------------------------------------
%
%\subsection{Generowanie pakietu oprogramowania}
%
%W~celu łatwej instacji powstałego oprogramowania, została przygotowana paczka instalacyjna... TODO

%------------------------------------------------------------------------------
%
%\subsection{Wireshark}
%
%Wireshark jest narzędziem do~analizowania pakietów i~dlatego był jednym z~najczęściej z~używanych narzędzi w~czasie implementacji projektu. Bez Wiresharka podgląd przesyłanych pakietów byłby trudny, szczególnie, że~przesyłane pakiety są~szyfrowane z~wykorzystaniem biblioteki OpenSSL~(patrz rozdział~\ref{sec:security}). Wireshark umożliwia łatwe dekodowanie pakietów po~podaniu klucza prywatnego użytego do~szyfrowania, co~czyni z~niego bardzo wygodne narzędzie do~analizy zaszyfrowanego ruchu sieciowego.

\end{document}
