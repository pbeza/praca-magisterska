% MYSCM-CLI(1) myscm-cli User Manuals
% Patryk Bęza
% August 4, 2017

# NAME

`myscm-cli` - client side of the mySCM application managing software and
configuration of the GNU/Linux workstations.

mySCM is simple Software Configuration Management (SCM) tool for managing
software and configuration of the clients running GNU/Linux distributions.
This application is intended to apply system image created with `myscm-srv`
application.

# SYNOPSIS

myscm-cli.py [*options*] *action*

Functionality of this application boils down to applying configuration changes
generated by the server to the client.  All the changes in the client's system
configuration are described within mySCM system image created with `--gen-img`
option of the `myscm-srv` application.  Besides applying changes, `myscm-cli`
application is able to download those changes from peer (which is typically
other client) and verify both authenticity of the mySCM system image (by
verifying its SSL digital signature) and its logical consistency.  `myscm-cli`
is able to download mySCM system image from other host using e.g. SFTP protocol
using credentials provided in configuration file.

# OPTIONS

-c *FILE*, \--config=*FILE*
:   Read `myscm-cli` configuration from specified *FILE* instead of default
    `/etc/myscm-cli/config.ini` file.  This file determines e.g. logging
    options, SSL certificate path that is used to verify digital SSL signature
    of the mySCM system image and more.

\--force
:   Take default actions and don't ask interactive questions (e.g. while
    running `--apply-img` option).

-l, \--list
:   List all locally available mySCM system images created with `myscm-srv`
    `--gen-img` and print information whether they have respective verified SSL
    digital signatures.  Signatures need to be placed in the same dictinary as
    mySCM system images to be recognized (by default in
    '/var/lib/myscm-cli/downloaded').

\--print-ver
:   Print recently applied mySCM system image version (ie. print current mySCM
    system version).  If no image was applied yet, then -1 is printed.  mySCM
    system image version is referred in mySCM system image filename, e.g.
    `myscm-img.1.2.tar.gz` system image is intended to be applied on the system
    that is in state *1* and is going to be upgraded to state *2*.

-p *PROTO*, \--protocol=*PROTO*
:   Select protocol that is preferred to be used to download newest mySCM
    system image generated by the `myscm-srv` with `--gen-img` option.  mySCM
    system images are downloaded either from `HOST` provided by `--update`
    option or from randomly selected host from `PeersList` variable read from
    configuration file.  If `HOST` argument was not provided with `--update`
    option, then this option is intended to filter out `PeersList`, so that
    only peer with protocol *PROTO* can be randomly selected.  If randomly
    selected host doesn't have applicable mySCM system image, then next peer is
    randomly selected until there are no peers left.  This option makes sense
    only with `--update` and `--upgrade` options.  Currently the only accepted
    protocol is *SFTP*.

\--ssl-cert=*PATH*
:   Full *PATH* to the server's SSL certificate that is being used to verify
    signature of the system image generated by the `myscm-srv` (default value:
    '/etc/myscm-cli/ssl.sig').

\--ssl-pubkey=*PATH*
:   Full *PATH* to the server's public key of the SSL certificate that is being
    used to verify signature of the mySCM system image generated with the
    `myscm-srv` `--gen-img` option.

# ACTIONS

\--apply-img=*SYS_IMG_VER*
:   Apply changes to the client's system effectively upgrading it to the system
    state identified by unique *SYS_IMG_VER* identifier.  Applied mySCM system
    image is read from `myscm-img.A.B.tar.gz` file where `B` is *SYS_IMG_VER*
    and `A` is integer representing current state of the system which can be
    obtained by running application with `--print-ver` option.

\--update=[*HOST*]
:   Update mySCM system image by downloading it from *HOST* (which can be
    peer's IP or hostname) or, if *HOST* is not specified, from randomly chosen
    client from *PeersList* variable read from configuration file.  Connection
    is being established using protocol defined by `--protocol` option or by
    configuration file if `--protocol` option is not present.  Downloaded file
    is saved in `/var/myscm-cli/myscm-img.A.B.tar.gz` where `A` and `B` are
    non-negative integers referring to the current and target system version
    respectively.

\--upgrade=[*SYS_IMG_VER*]
:   Equivalent of running `--update` and then `--apply-img` *SYS_IMG_VER*
    option.  If *SYS_IMG_VER* is not given then downloaded mySCM system image
    is applied.

-k, \--config-check
:   Check if application configuration is valid.  If it's valid, then exit
    status is 0 (see `$?` variable) and `Config OK` message is printed on
    stdout.  Otherwise exit status is 1 and no message is printed.

\--verify *SIGNATURE_PATH* *SIGNED_PATH*
:   Verify given SSL signature *SIGNATURE_PATH* of the given file
    *SIGNED_PATH*.

\--verify-img=*PATH*
:   Verify signature of the given system image.

-v, \--verbose
:   Increase output and log verbosity.  Default value is `0`.

-h, \--help
:   Show help message (which is short version of this manual page) and exit.

\--version
:   Print version information and exit.

# EXIT STATUS

If no error occurred the exit status is `0`.  Otherwise `1` is returned.

# COPYRIGHT

Copyright © 2017 Patryk Bęza  
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>.  
This is free software: you are free to change and redistribute it.  
There is NO WARRANTY, to the extent permitted by law.

# BUGS

Email bug reports to the bug-reporting address <bezap@student.mini.pw.edu.pl>.
For now, no bug tracker is available.

# SEE ALSO

`myscm-srv` (1).

You can learn more details about mySCM software from project white paper.  The
`myscm-cli` source code and all documentation may be downloaded from GitHub
repository of the project <https://github.com/pbeza/myscm>.

# NOTES

This software is part of the master thesis project.  To learn more about this
implementation, refer to project white paper.
